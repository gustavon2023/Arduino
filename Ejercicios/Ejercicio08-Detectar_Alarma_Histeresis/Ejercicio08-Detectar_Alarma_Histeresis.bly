<xml xmlns="http://www.w3.org/1999/xhtml"><block type="controls_setupLoop" id="2" deletable="false" x="0" y="0"><statement name="SETUP"><block type="variables_local" id="3" inline="false"><field name="VAR">analogValue</field><value name="VALUE"><block type="inout_analog_read" id="4" inline="true"><value name="PIN"><block type="pin_analog" id="5"><field name="PIN">A0</field></block></value></block></value><next><block type="controls_if" id="6" inline="false"><mutation else="1"></mutation><value name="IF0"><block type="logic_compare" id="7" inline="true"><field name="OP">GT</field><value name="A"><block type="variables_get" id="8"><field name="VAR">analogValue</field></block></value><value name="B"><block type="variables_get" id="9"><field name="VAR">threshold</field></block></value></block></value><statement name="DO0"><block type="variables_set" id="10" inline="false"><field name="VAR">alarma</field><value name="VALUE"><block type="math_number" id="11"><field name="NUM">1</field></block></value><next><block type="variables_set" id="87" inline="false"><field name="VAR">threshold</field><value name="VALUE"><block type="math_arithmetic" id="96" inline="true"><field name="OP">MINUS</field><value name="A"><block type="variables_get" id="110"><field name="VAR">threshold</field></block></value><value name="B"><block type="variables_get" id="118"><field name="VAR">histeresis</field></block></value></block></value></block></next></block></statement><statement name="ELSE"><block type="variables_set" id="12" inline="false"><field name="VAR">alarma</field><value name="VALUE"><block type="math_number" id="13"><field name="NUM">0</field></block></value><next><block type="variables_set" id="119" inline="false"><field name="VAR">threshold</field><value name="VALUE"><block type="math_arithmetic" id="120" inline="true"><field name="OP">ADD</field><value name="A"><block type="variables_get" id="121"><field name="VAR">threshold</field></block></value><value name="B"><block type="variables_get" id="122"><field name="VAR">histeresis</field></block></value></block></value></block></next></block></statement></block></next></block></statement><statement name="LOOP"><block type="variables_global" id="14" inline="false"><field name="VAR">alarma</field><value name="VALUE"><block type="math_number" id="15"><field name="NUM">0</field></block></value><next><block type="variables_global" id="16" inline="false"><field name="VAR">threshold</field><value name="VALUE"><block type="math_number" id="17"><field name="NUM">400</field></block></value><next><block type="variables_global" id="64" inline="false"><field name="VAR">histeresis</field><value name="VALUE"><block type="math_number" id="73"><field name="NUM">50</field></block></value><next><block type="variables_local" id="18" inline="false"><field name="VAR">analogValue</field><value name="VALUE"><block type="inout_analog_read" id="19" inline="true"><value name="PIN"><block type="pin_analog" id="20"><field name="PIN">A0</field></block></value></block></value><next><block type="controls_if" id="21" inline="false"><mutation else="1"></mutation><value name="IF0"><block type="logic_compare" id="22" inline="true"><field name="OP">GT</field><value name="A"><block type="variables_get" id="23"><field name="VAR">analogValue</field></block></value><value name="B"><block type="variables_get" id="24"><field name="VAR">threshold</field></block></value></block></value><statement name="DO0"><block type="controls_if" id="25" inline="false"><value name="IF0"><block type="logic_compare" id="26" inline="true"><field name="OP">EQ</field><value name="A"><block type="variables_get" id="27"><field name="VAR">alarma</field></block></value><value name="B"><block type="math_number" id="28"><field name="NUM">0</field></block></value></block></value><statement name="DO0"><block type="inout_digital_write" id="29" inline="true"><field name="STAT">HIGH</field><value name="PIN"><block type="pin_digital" id="30"><field name="PIN">13</field></block></value><next><block type="variables_set" id="31" inline="false"><field name="VAR">alarma</field><value name="VALUE"><block type="math_number" id="32"><field name="NUM">1</field></block></value><next><block type="variables_set" id="123" inline="false"><field name="VAR">threshold</field><value name="VALUE"><block type="math_arithmetic" id="124" inline="true"><field name="OP">MINUS</field><value name="A"><block type="variables_get" id="125"><field name="VAR">threshold</field></block></value><value name="B"><block type="variables_get" id="126"><field name="VAR">histeresis</field></block></value></block></value><next><block type="serial_println" id="33" inline="false"><value name="CONTENT"><block type="text" id="34"><field name="TEXT">ALARMA!!!!!!!!!!!!!!</field></block></value></block></next></block></next></block></next></block></statement></block></statement><statement name="ELSE"><block type="controls_if" id="35" inline="false"><value name="IF0"><block type="logic_compare" id="36" inline="true"><field name="OP">EQ</field><value name="A"><block type="variables_get" id="37"><field name="VAR">alarma</field></block></value><value name="B"><block type="math_number" id="38"><field name="NUM">1</field></block></value></block></value><statement name="DO0"><block type="inout_digital_write" id="39" inline="true"><field name="STAT">LOW</field><value name="PIN"><block type="pin_digital" id="40"><field name="PIN">13</field></block></value><next><block type="variables_set" id="41" inline="false"><field name="VAR">alarma</field><value name="VALUE"><block type="math_number" id="42"><field name="NUM">0</field></block></value><next><block type="variables_set" id="127" inline="false"><field name="VAR">threshold</field><value name="VALUE"><block type="math_arithmetic" id="128" inline="true"><field name="OP">ADD</field><value name="A"><block type="variables_get" id="129"><field name="VAR">threshold</field></block></value><value name="B"><block type="variables_get" id="130"><field name="VAR">histeresis</field></block></value></block></value><next><block type="serial_println" id="43" inline="false"><value name="CONTENT"><block type="text" id="44"><field name="TEXT">ALARMA RECUPERADA</field></block></value></block></next></block></next></block></next></block></statement></block></statement><next><block type="serial_print" id="45" inline="false"><value name="CONTENT"><block type="variables_get" id="46"><field name="VAR">analogValue</field></block></value><next><block type="serial_print" id="47" inline="false"><value name="CONTENT"><block type="text" id="48"><field name="TEXT"> </field></block></value><next><block type="serial_print" id="49" inline="false"><value name="CONTENT"><block type="variables_get" id="50"><field name="VAR">threshold</field></block></value><next><block type="serial_print" id="51" inline="false"><value name="CONTENT"><block type="text" id="52"><field name="TEXT"> </field></block></value><next><block type="serial_println" id="53" inline="false"><value name="CONTENT"><block type="math_arithmetic" id="54" inline="true"><field name="OP">MULTIPLY</field><value name="A"><block type="variables_get" id="55"><field name="VAR">alarma</field></block></value><value name="B"><block type="math_number" id="56"><field name="NUM">1024</field></block></value></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>